version: "3.3"

services:

  vis_ingest1:
    image: sip
    entrypoint: python3
    command: /home/sdp/sip/tasks/tests/example_recv_vis_data.py
    volumes:
      - type: volume
        source: vis-vol1
        target: /home/sdp/output
    networks:
      - outside
    deploy:
      mode: global
      placement:
        constraints:
          - node.ID == o74v00x1m94tknquwgo9vnuac
      labels:
        com.dn.description: "Host networking"

  vis_ingest2:
    image: sip
    entrypoint: python3
    command: /home/sdp/sip/tasks/tests/example_recv_vis_data.py /home/sdp/sip/etc/vis_receiver_config.json
    volumes:
      - type: volume
        source: vis-vol2
        target: /home/sdp/output
    networks:
      - outside
    deploy:
      mode: global
      placement:
        constraints:
          - node.ID == 0coaf8cgsbutedi6zqmnbq4gc
      labels:
        com.dn.description: "Host networking"

  vis_ingest3:
    image: sip
    entrypoint: python3
    command: /home/sdp/sip/tasks/tests/example_recv_vis_data.py /home/sdp/sip/etc/vis_receiver_config.json
    volumes:
      - type: volume
        source: vis-vol3
        target: /home/sdp/output
    networks:
      - outside
    deploy:
      mode: global
      placement:
        constraints:
          - node.ID == 95q8n5ier7zc5x9w546j0x76o
      labels:
        com.dn.description: "Host networking"

networks:
  outside:
    external:
      name: "host"

volumes:
    vis-vol1:
        external: True
    vis-vol2:
        external: True
    vis-vol3:
        external: True
