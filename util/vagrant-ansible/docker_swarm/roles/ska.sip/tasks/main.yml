--- # Git checkout of the SIP code
# ansible-playbook -i hosts -v --private-key=/Users/bmort/.vagrant.d/insecure_private_key playbook.yml
# https://github.com/geerlingguy/ansible-role-git
- name: Ensure Git is installed (Debian)
  apt:
    name: git
    state: present
    update_cache: yes
    cache_valid_time: 86400
  become: True

# http://docs.ansible.com/ansible/git_module.html
- name: Get the lastest release of SIP
  git:
    repo: https://github.com/SKA-ScienceDataProcessor/integration-prototype.git
    dest: /home/ubuntu/integration-prototype.git
    update: yes
    version: "{{ sip_branch }}"

- name: Install python3-pip
  apt:
    name: python3-pip
    state: latest
    update_cache: yes
    cache_valid_time: 3600
  become: True

#- name: Install boost python
#  apt:
#    name: libboost-python-dev
#    state: latest
#    update_cache: yes
#    cache_valid_time: 3600
#  become: True
#
#- name: Install boost program options
#  apt:
#    name: libboost-program-options-dev
#    state: latest
#    update_cache: yes
#    cache_valid_time: 3600
#  become: True
#
#- name: Install boost system
#  apt:
#    name: libboost-system-dev
#    state: latest
#    update_cache: yes
#    cache_valid_time: 3600
#  become: True

- name: Update pip
  pip:
    executable: pip3
    name: pip
    state: latest

- name: Install SIP Python deps
  pip:
    executable: pip3
    requirements: /home/ubuntu/integration-prototype.git/requirements.txt
  become: True

- name: Install SIP Python package
  pip:
    executable: pip3
    name: file:///home/ubuntu/integration-prototype.git
  become: True

# http://docs.ansible.com/ansible/docker_image_module.html
#- name: Build SIP slave docker image.
#  docker_image:
#    name: slave_controller
#    path:
